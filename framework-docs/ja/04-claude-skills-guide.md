# Claude Code Skills ガイド

Claude Code の Skills 機能による知識のカプセル化と作業自動化について解説します。

---

## 目次

1. [Skills とは](#1-skills-とは)
2. [インストール](#2-インストール)
3. [Skills の仕組み](#3-skills-の仕組み)
4. [Skills の配置場所](#4-skills-の配置場所)
5. [SKILL.md の構造](#5-skillmd-の構造)
6. [Skills の作成方法](#6-skills-の作成方法)
7. [実践的な Skills 例](#7-実践的な-skills-例)
8. [玄人開発カスタム Skills](#8-玄人開発カスタム-skills)
9. [スラッシュコマンド・サブエージェントとの違い](#9-スラッシュコマンドサブエージェントとの違い)
10. [ベストプラクティス](#10-ベストプラクティス)
11. [トラブルシューティング](#11-トラブルシューティング)

---

## 1. Skills とは

### 1.1 概要

Skills（スキル）は、特定のタスクに関するノウハウや手順をひとまとめにしたモジュールです。Claude が自律的に判断し、必要に応じて適用する「知識パック」として機能します。

### 1.2 Skills の特徴

| 特徴 | 説明 |
|------|------|
| **自動適用** | Claude がユーザーの依頼内容を分析し、関連する Skill を自動的に選択・適用 |
| **プログレッシブディスクロージャー** | 必要な情報のみを段階的に読み込み、コンテキストを効率的に使用 |
| **モジュール化** | 指示、スクリプト、リソースをフォルダ単位で管理 |
| **チーム共有** | Git でバージョン管理し、チーム全体で共有可能 |

### 1.3 Skills のメリット

- **トークン消費の削減**: 必要な時のみコンテキストに読み込むため、最大 98% のトークン削減が可能（事例報告）
- **品質の一貫性**: チーム固有のルールや手順を標準化
- **再利用性**: 一度作成した Skill を複数のプロジェクトで活用
- **自動化**: 手動での指示なしに Claude が適切な Skill を適用

---

## 2. インストール

### 2.1 前提条件

- Claude Code がインストールされていること
- clauto-develop リポジトリをクローン済み

### 2.2 グローバルインストール

すべてのプロジェクトでカスタムスキルを使用するには、以下のコマンドを実行します：

```bash
# clauto-develop リポジトリのルートディレクトリで実行
mkdir -p ~/.claude/skills
cp -r global-skills/* ~/.claude/skills/
```

### 2.3 インストール確認

以下のディレクトリ構造が作成されていることを確認します：

```
~/.claude/skills/
├── spec-reviewer/
├── architecture-reviewer/
├── coding-standards/
├── test-author/
├── debug-triage/
├── pr-reviewer/
├── security-baseline/
├── dependency-change-reviewer/
└── release-notes-writer/
```

### 2.4 アンインストール

```bash
rm -rf ~/.claude/skills/*
```

---

## 3. Skills の仕組み

### 3.1 プログレッシブディスクロージャー（段階的情報開示）

Skills は 3 層構造で設計されており、必要に応じて段階的に情報を読み込みます。

```
第1層: メタデータ（name, description）
  ↓ 起動時にシステムプロンプトに組み込み
  ↓ Claude がスキル利用を判断

第2層: SKILL.md 本体
  ↓ 関連性があると判断された場合に読み込み

第3層: 補足ファイル（スクリプト、テンプレート等）
  ↓ 特定シナリオでのみ読み込み
```

### 2.2 Skill の発見と呼び出し

1. **起動時**: Claude Code が利用可能な Skill の `name` と `description` を読み込み
2. **分析**: ユーザーのリクエストと Skill の description を照合
3. **確認**: マッチする Skill があれば「○○という Skill を使っていいですか？」と確認
4. **読み込み**: 承認後、`SKILL.md` の本体をコンテキストに読み込み
5. **実行**: 指示に従って処理を実行

### 2.3 Skill ツールの内部動作

```
ユーザーリクエスト
    ↓
Claude が Skill ツールを呼び出し
    ↓
システムが SKILL.md を読み込み
    ↓
コンテキストに指示を注入
    ↓
Claude が指示に従って実行
```

---

## 4. Skills の配置場所

### 3.1 配置ディレクトリ

| 配置場所 | スコープ | 用途 |
|---------|---------|------|
| `.claude/skills/` | プロジェクト固有 | プロジェクト専用の Skill |
| `~/.claude/skills/` | 全プロジェクト共通 | 個人用の汎用 Skill |
| プラグイン提供 | プラグイン経由 | サードパーティ Skill |

### 3.2 ディレクトリ構造

```
.claude/skills/
├── code-review/
│   ├── SKILL.md           # メイン Skill ファイル
│   ├── scripts/
│   │   └── analyze.py     # 補助スクリプト
│   └── resources/
│       └── checklist.md   # チェックリスト
├── documentation/
│   ├── SKILL.md
│   └── templates/
│       └── api-doc.md
└── testing/
    └── SKILL.md
```

---

## 5. SKILL.md の構造

### 5.1 基本構造

```markdown
---
name: Skill の名前
description: Skill の説明（いつ使用するか）
---

# Skill のタイトル

ここに Claude への詳細な指示を記述
```

### 4.2 フロントマター（メタデータ）

#### 必須フィールド

| フィールド | 説明 | 制限 |
|-----------|------|------|
| `name` | Skill の名前 | 64 文字以下 |
| `description` | Skill の説明と使用条件 | 200 文字以下 |

#### オプションフィールド

| フィールド | 説明 | 例 |
|-----------|------|-----|
| `allowed-tools` | 許可するツール | `Read, Grep, Glob` |
| `dependencies` | 必要なパッケージ | `python>=3.8, pandas>=1.5.0` |

### 4.3 description の重要性

`description` は Claude が Skill を呼び出すかどうかを判断する最も重要な要素です。

**良い例:**
```yaml
description: TypeScript プロジェクトのコードレビューを実施。セキュリティ、パフォーマンス、コーディング規約をチェック。PR レビュー時に使用。
```

**悪い例:**
```yaml
description: コードレビュー用
```

### 4.4 フロントマターの注意点

- `---` は必ず 1 行目から開始（空行禁止）
- インデントはスペースを使用（タブ禁止）
- ファイル名は `SKILL.md`（大文字・小文字を区別）

---

## 6. Skills の作成方法

### 5.1 最小構成

```
my-skill/
└── SKILL.md
```

```markdown
---
name: コード品質チェック
description: TypeScript コードの品質をチェック。リント、型エラー、ベストプラクティスを確認。
---

# コード品質チェック

以下の観点でコードをチェックしてください：

1. **型安全性**: any 型の使用を最小限に
2. **命名規則**: キャメルケース、パスカルケースの適切な使用
3. **エラーハンドリング**: try-catch の適切な使用
4. **コメント**: 複雑なロジックへの説明コメント
```

### 5.2 スクリプトを含む構成

```
advanced-skill/
├── SKILL.md
├── scripts/
│   └── analyze.sh
└── resources/
    └── rules.json
```

```markdown
---
name: 依存関係分析
description: プロジェクトの依存関係を分析し、セキュリティリスクを検出。npm audit の実行が必要な場合に使用。
allowed-tools: Bash(npm:*)
---

# 依存関係分析

## 手順

1. `scripts/analyze.sh` を実行して依存関係を分析
2. `resources/rules.json` のルールに基づいて評価
3. 問題があれば修正案を提示

## スクリプトの実行

\`\`\`bash
./scripts/analyze.sh
\`\`\`
```

### 5.3 ファイル参照

SKILL.md 内で他のファイルを参照できます。

```markdown
詳細なチェックリストは以下を参照：

@resources/checklist.md

テンプレートを使用する場合：

@templates/component.tsx
```

---

## 7. 実践的な Skills 例

### 6.1 コードレビュー Skill

`.claude/skills/code-review/SKILL.md`:

```markdown
---
name: コードレビュー
description: Pull Request のコードレビューを実施。セキュリティ、パフォーマンス、可読性をチェック。
allowed-tools: Read, Grep, Glob
---

# コードレビュー Skill

## レビュー観点

### セキュリティ
- SQL インジェクションの脆弱性
- XSS の脆弱性
- 認証・認可の問題
- 機密情報のハードコード

### パフォーマンス
- N+1 問題
- 不要なループ
- メモリリーク
- 非効率なアルゴリズム

### コード品質
- 命名の明確さ
- 関数の単一責任
- コメントの適切さ
- テストの網羅性

## 出力形式

| 重要度 | ファイル:行 | 問題 | 修正案 |
|--------|------------|------|--------|
| Critical/Major/Minor | path:line | 説明 | 提案 |
```

### 6.2 ドキュメント生成 Skill

`.claude/skills/documentation/SKILL.md`:

```markdown
---
name: API ドキュメント生成
description: TypeScript/JavaScript のコードから API ドキュメントを自動生成。JSDoc コメントを解析。
---

# API ドキュメント生成 Skill

## 対象

- 関数、クラス、インターフェース
- エクスポートされた型定義
- REST API エンドポイント

## 出力形式

### 関数ドキュメント

\`\`\`markdown
## 関数名

**説明**: 関数の目的

**パラメータ**:
| 名前 | 型 | 必須 | 説明 |
|------|-----|------|------|

**戻り値**: 型と説明

**例**:
\`\`\`typescript
// 使用例
\`\`\`
\`\`\`

## 言語

- ドキュメントは日本語で生成
- コード例はそのまま維持
```

### 6.3 テスト生成 Skill

`.claude/skills/testing/SKILL.md`:

```markdown
---
name: ユニットテスト生成
description: TypeScript 関数のユニットテストを自動生成。Jest/Vitest 形式でテストケースを作成。
allowed-tools: Read, Write
---

# ユニットテスト生成 Skill

## テスト構造

\`\`\`typescript
describe('関数名', () => {
  describe('正常系', () => {
    it('期待する動作の説明', () => {
      // Arrange
      // Act
      // Assert
    });
  });

  describe('異常系', () => {
    it('エラーケースの説明', () => {
      // テスト
    });
  });
});
\`\`\`

## カバレッジ目標

- 正常系: 主要なユースケース
- 異常系: エラーハンドリング
- 境界値: 限界値のテスト
- null/undefined の処理

## 命名規則

- describe: 対象の名前
- it: 「〜する」形式で動作を記述
```

### 6.4 ブランドガイドライン Skill

`.claude/skills/brand-guidelines/SKILL.md`:

```markdown
---
name: ブランドガイドライン
description: 社内ブランドガイドラインをドキュメントやプレゼンテーションに適用。UI テキスト、メッセージ作成時に使用。
---

# ブランドガイドライン Skill

## トーン & ボイス

- **親しみやすい**: 堅苦しくない表現
- **明確**: 専門用語を避け、わかりやすく
- **プロフェッショナル**: 信頼感のある表現

## 用語統一

| 使用する | 使用しない |
|---------|-----------|
| ユーザー | お客様、利用者 |
| ログイン | サインイン |
| 設定 | 環境設定、オプション |

## UI テキスト

- ボタン: 動詞で開始（例: 保存する、送信する）
- エラー: 問題と解決策を明示
- 確認: 肯定的な表現を先に
```

---

## 8. 玄人開発カスタム Skills

本プロジェクトで提供する 12 個のカスタム Skills です。`~/.claude/skills/` に配置して全プロジェクトで利用できます。

### 7.1 Skills 一覧

| カテゴリ | Skill 名 | 目的 |
|---------|---------|------|
| **仕様** | spec-writer | 要求を仕様書テンプレートに落とし込む |
| **仕様** | spec-reviewer | 仕様の品質ゲート（曖昧さ・漏れ・矛盾検出） |
| **計画** | plan-generator | 仕様からタスク分解を標準粒度で作成 |
| **設計** | architecture-reviewer | 責務分離・レイヤ設計のレビュー |
| **実装** | coding-standards | コーディング規約の適用 |
| **テスト** | test-author | 仕様からテスト観点とコードを生成 |
| **デバッグ** | debug-triage | 問題の原因切り分け |
| **レビュー** | pr-reviewer | PR レビュー観点の標準化 |
| **PR** | pr-writer | PR 本文のフォーマット統一 |
| **リリース** | release-notes-writer | リリースノートの型化 |
| **セキュリティ** | security-baseline | セキュリティレビューの標準化 |
| **依存** | dependency-change-reviewer | 依存パッケージ変更のレビュー |

### 7.2 開発フェーズ別 Skills マップ

```
要求 ─────────────────────────────────────────────────────→ リリース

[要求分析]        [設計]           [実装]         [レビュー]      [リリース]
    │               │                │               │               │
    ▼               ▼                ▼               ▼               ▼
spec-writer    architecture-    coding-       pr-reviewer    release-notes-
    │          reviewer         standards          │          writer
    ▼               │                │               │
spec-reviewer      │           test-author          │
    │               │                │               │
    ▼               │                ▼               │
plan-generator     │          debug-triage          │
                   │                                 │
                   └─────────────────────────────────┘
                            security-baseline
                       dependency-change-reviewer
```

### 7.3 各 Skill の詳細

#### spec-writer（仕様書作成）

| 項目 | 内容 |
|-----|------|
| **目的** | 要求を `docs/spec.md` のテンプレート構造に落とし込む |
| **使用場面** | 要件が口頭/箇条書きで渡されたとき、最初に Spec を起こすとき |
| **主な機能** | 目的/機能要件/入力/出力/エラー/禁止事項/ディレクトリ構成を網羅、曖昧語禁止、成功・失敗例必須 |

#### spec-reviewer（仕様書レビュー）

| 項目 | 内容 |
|-----|------|
| **目的** | Spec の品質ゲート（曖昧さ・漏れ・矛盾の検出） |
| **使用場面** | 実装開始前、仕様変更後 |
| **主な機能** | 曖昧語チェック、優先順位確認、バリデーション確認、例の確認、非機能要件（性能/セキュリティ）チェック |

#### plan-generator（実装計画生成）

| 項目 | 内容 |
|-----|------|
| **目的** | Spec → Plan のタスク分解を「いつも同じ粒度」で作成 |
| **使用場面** | 実装開始前、作業見積もり・分担 |
| **主な機能** | 依存関係整理、段階的 PR 戦略、リスク分析、検証ステップ、ロールバック観点 |

#### architecture-reviewer（アーキテクチャレビュー）

| 項目 | 内容 |
|-----|------|
| **目的** | 責務分離・ディレクトリ/レイヤ設計のレビューを型化 |
| **使用場面** | 大きめの機能追加、初期構築、リファクタ前 |
| **主な機能** | 境界チェック（domain/app/infra 等）、循環依存検出、I/O 層の分離確認、将来拡張点の明示 |

#### coding-standards（コーディング規約）

| 項目 | 内容 |
|-----|------|
| **目的** | チームの「書き方の標準」を都度適用（レビュー含む） |
| **使用場面** | 実装・レビュー全般 |
| **主な機能** | 命名規則、例外設計、ログ方針、コメント規約、関数設計、依存注入、型/Null 方針 |

> **Note**: CLAUDE.md に全部入れると重いので、Skills で必要時のみ適用するのが効果的です。

#### test-author（テスト作成）

| 項目 | 内容 |
|-----|------|
| **目的** | Spec からテスト観点とテストコード生成を標準化 |
| **使用場面** | 新機能、バグ修正、回帰テスト追加 |
| **主な機能** | 正常/異常/境界値の観点整理、モック方針、テスト命名規則、テストデータ作成ルール |

#### debug-triage（デバッグトリアージ）

| 項目 | 内容 |
|-----|------|
| **目的** | ログ/スタックトレース/再現手順から原因切り分けの型 |
| **使用場面** | 原因不明バグ、CI 失敗、パフォーマンス劣化 |
| **主な機能** | 再現最小化、仮説→検証コマンド提案、観測ポイント特定、暫定回避策 |

#### pr-reviewer（PR レビュー）

| 項目 | 内容 |
|-----|------|
| **目的** | PR レビュー観点を固定（仕様逸脱・テスト漏れ・安全性） |
| **使用場面** | PR 作成後、レビュー依頼時 |
| **主な機能** | Spec 準拠確認、影響範囲、後方互換性、ログ/メトリクス、セキュリティ、ドキュメント更新 |

#### pr-writer（PR 作成）

| 項目 | 内容 |
|-----|------|
| **目的** | PR 本文のフォーマット統一（変更点/理由/テスト/影響/手順） |
| **使用場面** | PR 作成前 |
| **主な機能** | テンプレ固定、チェックボックス、レビュー観点、デプロイ/ロールバック手順、スクショ要否 |

#### release-notes-writer（リリースノート作成）

| 項目 | 内容 |
|-----|------|
| **目的** | リリースノート/変更通知の型（社内外向け） |
| **使用場面** | リリース時、顧客向け告知 |
| **主な機能** | ユーザー影響、破壊的変更、移行手順、既知の制限、監視ポイント |

#### security-baseline（セキュリティベースライン）

| 項目 | 内容 |
|-----|------|
| **目的** | 最低限のセキュリティレビューを毎回抜けなく |
| **使用場面** | 外部 I/O、認証認可、ファイル/ネットワーク、依存追加 |
| **主な機能** | 入力検証、権限チェック、Secrets 管理、PII 取り扱い、SSRF/SQLi/XSS 対策、ログの安全性 |

#### dependency-change-reviewer（依存パッケージ変更レビュー）

| 項目 | 内容 |
|-----|------|
| **目的** | 依存追加・アップデート時の確認観点を固定 |
| **使用場面** | 新ライブラリ導入、バージョン更新 |
| **主な機能** | ライセンス確認、脆弱性チェック、サイズ/ビルド影響、代替候補検討、ロックファイル方針 |

### 7.4 Skills の配置場所

```
~/.claude/skills/
├── spec-writer/
│   └── SKILL.md
├── spec-reviewer/
│   └── SKILL.md
├── plan-generator/
│   └── SKILL.md
├── architecture-reviewer/
│   └── SKILL.md
├── coding-standards/
│   └── SKILL.md
├── test-author/
│   └── SKILL.md
├── debug-triage/
│   └── SKILL.md
├── pr-reviewer/
│   └── SKILL.md
├── pr-writer/
│   └── SKILL.md
├── release-notes-writer/
│   └── SKILL.md
├── security-baseline/
│   └── SKILL.md
└── dependency-change-reviewer/
    └── SKILL.md
```

### 7.5 使用例

```
# 仕様書作成
ユーザー: 「ユーザー認証機能の仕様書を作成して」
→ spec-writer Skill が自動適用

# 仕様レビュー
ユーザー: 「この仕様書をレビューして」
→ spec-reviewer Skill が自動適用

# 実装計画
ユーザー: 「この仕様から実装計画を作って」
→ plan-generator Skill が自動適用

# PR 作成
ユーザー: 「PR を作成して」
→ pr-writer Skill が自動適用

# セキュリティレビュー
ユーザー: 「このコードのセキュリティをチェックして」
→ security-baseline Skill が自動適用
```

---

## 9. スラッシュコマンド・サブエージェントとの違い

### 8.1 比較表

| 項目 | Skills | スラッシュコマンド | サブエージェント |
|------|--------|------------------|----------------|
| **起動方法** | 自動（Claude 判断） | 手動（`/command`） | 自動/手動 |
| **コンテキスト** | メイン会話内 | メイン会話内 | 独立したコンテキスト |
| **用途** | 知識・ルールの適用 | 定型ワークフロー | 調査・分析タスク |
| **引数** | なし | あり（`$ARGUMENTS`） | タスク依頼文 |
| **配置場所** | `.claude/skills/` | `.claude/commands/` | `.claude/agents/` |

### 9.2 使い分けの指針

```
┌─────────────────────────────────────────────────────────────┐
│ 「常に適用すべきルールやガイドライン」                        │
│  → CLAUDE.md                                                 │
├─────────────────────────────────────────────────────────────┤
│ 「特定のタスクで Claude が自動的に適用すべき知識」           │
│  → Skills                                                    │
├─────────────────────────────────────────────────────────────┤
│ 「明示的に呼び出す定型ワークフロー」                         │
│  → スラッシュコマンド                                        │
├─────────────────────────────────────────────────────────────┤
│ 「独立したコンテキストで行う調査・分析」                     │
│  → サブエージェント                                          │
└─────────────────────────────────────────────────────────────┘
```

### 8.3 組み合わせの例

```
ユーザー: 「この PR をレビューして」

1. Claude が「コードレビュー」Skill を検出・適用
2. Skill 内の指示に従ってレビューを実施
3. 必要に応じてサブエージェント（code-reviewer）に委譲
4. レビュー完了後、スラッシュコマンド（/pr-comment）で結果を投稿
```

### 8.4 Boris Cherny 氏の見解

> 「まだ現状では私は Skill よりサブエージェントの方を多用している」

Skills はまだ新しい機能であり、呼び出しロジックの安定性向上が期待されています。現時点では：

- **確実な制御が必要**: サブエージェント推奨
- **自動適用で効率化したい**: Skills を試験的に導入

---

## 10. ベストプラクティス

### 9.1 設計原則

1. **焦点を絞る**
   - 1 つの Skill = 1 つの目的
   - 大きな Skill は分割する

2. **description を明確に**
   - いつ使用するかを具体的に記述
   - Claude の判断精度を高める

3. **シンプルに開始**
   - まず Markdown の指示のみで作成
   - 必要に応じてスクリプトを追加

4. **例を含める**
   - 入力例と出力例を記載
   - 期待する結果を明示

### 9.2 段階的な開発

```
1. 評価
   └─ 実際の使用場面で不足点を特定

2. 設計
   └─ SKILL.md の基本構造を作成

3. テスト
   └─ 様々な入力で動作を確認

4. 改善
   └─ 必要なコンテキストを調整

5. 分割
   └─ 複雑化したら補助ファイルに分離
```

### 9.3 セキュリティ

**警告**: Skills は指示とコードを通じて新機能を提供しますが、悪意ある Skill は脆弱性をもたらす可能性があります。

- 信頼できるソースからのみインストール
- 第三者の Skill は内容を確認してから使用
- `allowed-tools` で権限を最小化

### 9.4 チーム共有

```bash
# Git でバージョン管理
git add .claude/skills/
git commit -m "feat: コードレビュー Skill を追加"

# チームメンバーは clone/pull で取得
git pull origin main
```

---

## 11. トラブルシューティング

### 11.1 Skill が読み込まれない

```bash
# デバッグモードで起動
claude --debug
```

**チェックポイント**:
- ファイル名が `SKILL.md`（大文字・小文字を確認）
- フロントマターの形式が正しいか
- `---` が 1 行目から開始しているか
- インデントがスペースか（タブ禁止）

### 10.2 Skill が起動しない

**考えられる原因**:
- `description` がリクエストと一致しない
- より適切な Skill が優先されている

**対策**:
- `description` を具体的に書き直す
- トリガー条件を明確にする

### 10.3 期待通りに動作しない

**対策**:
- SKILL.md の指示を明確化
- 入出力例を追加
- ステップバイステップの手順に分解

---

## 参考資料

- [Claude Code 公式](https://claude.ai/code)
- [Anthropic 公式サイト](https://www.anthropic.com/)
- [Agent Skills ドキュメント](https://code.claude.com/docs/en/skills)
- [Agent Skills 設計思想](https://www.anthropic.com/engineering/equipping-agents-for-the-real-world-with-agent-skills)
- [Awesome Claude Skills](https://github.com/travisvn/awesome-claude-skills)

---

*このガイドは随時更新されます。Skills 機能は新しい機能のため、今後のアップデートで安定性と機能が向上する予定です。*
