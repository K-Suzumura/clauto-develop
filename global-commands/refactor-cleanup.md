# /refactor:cleanup - コード整理

振る舞いを変えずにコードを整理してください。

## 使用方法

```
/refactor:cleanup
/refactor:cleanup [対象パス]
/refactor:cleanup src/services/
```

## 実行内容

1. 対象コードの分析
2. 改善点の特定
3. リファクタリング実行
4. テストで振る舞いが変わっていないことを確認

## リファクタリング項目

### 1. 冗長コード削減
- [ ] 未使用のインポート
- [ ] 未使用の変数・関数
- [ ] 重複コード
- [ ] デッドコード

### 2. 命名改善
- [ ] 意図が不明確な変数名
- [ ] 略語の展開
- [ ] 一貫性のない命名

### 3. 構造整理
- [ ] 長すぎる関数の分割
- [ ] 深すぎるネストの解消
- [ ] 早期リターンへの変換
- [ ] マジックナンバーの定数化

### 4. コメント整理
- [ ] 古いコメントの削除
- [ ] TODO/FIXMEの確認
- [ ] 不要なコメントアウトの削除

## 実行フロー

### Phase 1: 分析
- 対象ファイルをスキャン
- 改善可能な箇所を特定
- 優先度を判定

### Phase 2: 計画
```markdown
## リファクタリング計画

### 高優先度
1. [ファイル:行] [問題] → [改善案]

### 中優先度
2. [ファイル:行] [問題] → [改善案]

### 低優先度
3. [ファイル:行] [問題] → [改善案]
```

### Phase 3: ユーザー確認
実行する項目を確認

### Phase 4: 実行
- 1つずつリファクタリング
- 各ステップでテスト実行
- 問題があればロールバック

### Phase 5: 検証
- 全テスト実行
- 振る舞いが変わっていないことを確認

## 出力形式

```markdown
# リファクタリング完了

## サマリー
- **対象ファイル数**: X件
- **変更箇所**: X箇所
- **削減行数**: -XX行

## 実施した改善

### 冗長コード削減
| ファイル | 変更内容 | 効果 |
|---------|---------|------|
| `file.ext` | 未使用インポート削除 | -5行 |
| `file.ext` | 重複コード統合 | -20行 |

### 命名改善
| ファイル | 変更前 | 変更後 |
|---------|--------|--------|
| `file.ext` | `tmp` | `temporaryResult` |

### 構造整理
| ファイル | 変更内容 |
|---------|---------|
| `file.ext` | 長い関数を3つに分割 |

## テスト結果
- [x] 全テスト合格
- [x] 振る舞いに変化なし

## 次のステップ
- `/git:commit` でコミット
- 必要に応じてレビュー依頼
```

## 注意事項

- 振る舞いを変更しない（テストが全て通ること）
- 1つのコミットにまとめるか、論理単位で分割するか選択可能
- 大規模な変更は段階的に実施
